<?php

/**
 * Created by PhpStorm.
 * User: lin11
 * Date: 2016/10/28
 * Time: 20:30
 */
class SignController extends Controller
{
    function login(){
        $this->assign('title','Orisport——你的运动管家');
        $this->needRender(true);
    }
    function account($type){
        switch ($type[0]){
            case 'verifying':
                $user = new UserCollection();
                $isCorrect= $user->loginVerify($_POST['username'],$_POST['password']);
                if($isCorrect){
                    if($_SESSION['role']=='manager'){
                        @header("location:".PAGE_MANAGER);
                    }else{
                        @header("location:".PAGE_DEFAULE);
                    }
                }else{
                    @header("location:".PAGE_LOGINFAIL);
                }
                break;
            case 'registration':
                $user = new UserCollection();
                $username = $_POST['username'];
                $password = $_POST['password'];
                $height = $_POST['height'];
                $weight = $_POST['weight'];
                $step_length = $_POST['step_length'];
                $user->registration($username,$password,$height,$weight,$step_length,date("Y-m-d"));
                @header("location:".PAGE_DEFAULE);
                break;
            default:
                break;
        }
    }
    function logout(){
        $_SESSION['id'] = NULL;
        $_SESSION['name'] = NULL;
        $_SESSION['role'] = NULL;
        @header("location:".PAGE_LOGIN);
    }
    function checkLogin()
    {
         // TODO: Change the autogenerated stub
    }
}